#!/bin/bash

# Pre-removal script for RemoteCompanion
# Stops running processes before package removal

set -e

echo "RemoteCompanion: Stopping running processes"

# Kill the rc_server if it's running
killall -9 rc_server.sh 2>/dev/null || true

# Kill the RemoteCompanion app if it's running
killall -9 RemoteCompanion 2>/dev/null || true

# Cleanup rootful symlink if applicable
if [ ! -L "/var/jb" ] && [ -L "/Applications/RemoteCompanion.app" ]; then
    echo "RemoteCompanion: Removing rootful symlink from /Applications"
    rm "/Applications/RemoteCompanion.app"
fi

echo "RemoteCompanion: Pre-removal cleanup complete"

exit 0
